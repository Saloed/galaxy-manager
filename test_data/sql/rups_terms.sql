SELECT
Semestr.F$SEMESTER AS Num
, SUM(CASE WHEN (TypeWorkMain.F$WTYPE = 4 OR TypeWorkMain.F$WTYPE = 23) THEN 1 END) AS exam
, SUM(CASE WHEN TypeWorkMain.F$WTYPE = 5 THEN 1 END) AS test
, SUM(CASE WHEN TypeWorkMain.F$WTYPE = 1 THEN DisCont.F$SIZE END) AS lections
, SUM(CASE WHEN TypeWorkMain.F$WTYPE = 2 THEN DisCont.F$SIZE END) AS labs
, SUM(CASE WHEN TypeWorkMain.F$WTYPE = 17 THEN DisCont.F$SIZE END) AS practice
, SUM(CASE WHEN TypeWorkMain.F$WTYPE = 10 THEN DisCont.F$SIZE END) AS [self]
FROM t$U_CURR_DISCONTENT DisCont
LEFT JOIN t$U_Curr_Semester Semestr ON DisCont.F$CSEMESTER = Semestr.F$NREC
INNER JOIN t$U_TYPEWORK TypeWorkMain ON DisCont.f$cTypeWork = TypeWorkMain.F$NREC
WHERE
DisCont.f$CCURR_DIS = CONVERT(BINARY(8), CONVERT(BIGINT,0x8000000000000000)+ CONVERT(BIGINT, %s))
GROUP BY Semestr.F$SEMESTER
